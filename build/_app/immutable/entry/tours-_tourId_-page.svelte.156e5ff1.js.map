{"version":3,"file":"tours-_tourId_-page.svelte.156e5ff1.js","sources":["../../../../../../src/components/PointDetail.svelte","../../../../../../src/routes/tours/[tourId]/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\r\n    import {createEventDispatcher} from \"svelte\";\r\n\r\n    export let ongoingTour;\r\n    export let mapPoint;\r\n    export let visited: boolean = false;\r\n    export let status;\r\n    const dispatch = createEventDispatcher();\r\n\r\n    function markAsVisited() {\r\n        visited = true;\r\n        ongoingTour.checkMapPoint(mapPoint['name']);\r\n        dispatch('update', {});\r\n    }\r\n</script>\r\n\r\n<div class=\"flex basis-4/6 flex-col\">\r\n    <p class=\"mb-2\">{mapPoint.description}</p>\r\n    {#if mapPoint.image !== null}\r\n        <img src=\"{mapPoint.image}\" alt=\"{mapPoint.name}\"\r\n             class=\"mb-2 aspect-auto rounded-lg object-cover\"/>\r\n    {/if}\r\n    <div class=\"flex items-center justify-between\">\r\n        <a href=\"http://maps.google.com/maps?z=12&t=m&q=loc:38.9419+-78.3020\" target=\"_blank\"\r\n           class=\"text-neutral-400 hover:text-neutral-100\">Zobraziť na mape ↗</a>\r\n        {#if visited === true}\r\n            <p class=\"cursor-not-allowed text-neutral-700\">Označiť ako navštívené ✓</p>\r\n        {:else if status === \"IN_PROGRESS\" && ongoingTour}\r\n            <button type=\"button\"\r\n                    on:click|preventDefault={markAsVisited}\r\n                    class=\"text-neutral-400 hover:text-neutral-100\">Označiť ako navštívené ✓\r\n            </button>\r\n        {/if}\r\n    </div>\r\n</div>","<script lang=\"ts\">\r\n    import type {PageData} from './$types';\r\n    import ContextButton from \"../../../components/ContextButton.svelte\";\r\n    import PointDetail from \"../../../components/PointDetail.svelte\";\r\n    import {derived, get, writable} from \"svelte/store\";\r\n\r\n    export let data: PageData;\r\n    const tourId = parseInt(data.tourId);\r\n\r\n    // @ts-ignore\r\n    let tour = ServiceManager.getTourService().getTour(tourId);\r\n\r\n    // @ts-ignore\r\n    let relationship = ServiceManager.getTourService().getUserTourRelationshipString(tourId);\r\n    console.log(relationship)\r\n    let ongoingData = writable(undefined);\r\n\r\n    if (relationship == \"IN_PROGRESS\") {\r\n        // @ts-ignore\r\n        ongoingData.set(ServiceManager.getTourService().getOngoingTour(tourId))\r\n        console.log($ongoingData);\r\n    }\r\n\r\n    let chosenPoint = tour['mapPoints'].get(0);\r\n    console.log(chosenPoint)\r\n\r\n    function hasVisited(pointName) {\r\n        console.log(\"hasVisited: \", pointName);\r\n        console.log($ongoingData);\r\n        if (relationship == \"IN_PROGRESS\") {\r\n            for (let i = 0; i < $ongoingData['visitedMapPoints'].length; i++) {\r\n                console.log(\"Checking: \", $ongoingData['visitedMapPoints'].at(i)['name'])\r\n                if ($ongoingData['visitedMapPoints'].at(i)['name'] == pointName) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    function goBack() {\r\n        history.back();\r\n    }\r\n\r\n    function selectPoint(pointName) {\r\n        console.log(pointName);\r\n        for (let i = 0; i < tour['mapPoints'].size; i++) {\r\n            console.log(tour['mapPoints'].get(i));\r\n            if (tour['mapPoints'].get(i)['name'] == pointName) {\r\n                chosenPoint = tour['mapPoints'].get(i);\r\n                console.log(\"Choosing: \", chosenPoint);\r\n            }\r\n        }\r\n    }\r\n\r\n    function handleUpdate(ev) {\r\n        console.log(\"HANDLING UPDATE\");\r\n        if (relationship == \"IN_PROGRESS\") {\r\n            // @ts-ignore\r\n            ongoingData.set(ServiceManager.getTourService().getOngoingTour(tourId));\r\n            // @ts-ignore\r\n            relationship = ServiceManager.getTourService().getUserTourRelationshipString(tourId);\r\n            console.log($ongoingData);\r\n        }\r\n    }\r\n\r\n    const formatStopName = derived(\r\n        ongoingData,\r\n        ($ongoingData) => (value) => {\r\n            if (relationship == \"FINISHED\")\r\n                return `${value['name']} ✓`;\r\n            else if (relationship != \"IN_PROGRESS\")\r\n                return `${value['name']}`;\r\n            else\r\n                return `${value['name']} ${$ongoingData['visitedMapPoints'].some(el => el.name === value['name']) ? '✓' : ''}`\r\n        }\r\n    )\r\n\r\n</script>\r\n\r\n<main class=\"flex items-center flex-col py-8 mx-48\">\r\n    <h1 class=\"mb-8 text-4xl font-bold\">City Guide Walks</h1>\r\n    <section class=\"w-full\">\r\n        <button type=\"button\"\r\n                on:click|preventDefault={goBack}\r\n                class=\"flex items-center gap-2 stroke-neutral-400 text-neutral-400 hover:stroke-neutral-100 hover:text-neutral-100\">\r\n            <svg width=\"24px\" height=\"24px\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" fill=\"none\"\r\n                 xmlns=\"http://www.w3.org/2000/svg\">\r\n                <path d=\"M21 12H3m0 0l8.5-8.5M3 12l8.5 8.5\" stroke-width=\"1.5\" stroke-linecap=\"round\"\r\n                      stroke-linejoin=\"round\"></path>\r\n            </svg>\r\n            Späť\r\n        </button>\r\n        <img src=\"https://sacr3-files.s3-eu-west-1.amazonaws.com/_processed_/csm_TT.korzo_93c23fef75.jpg\"\r\n             class=\"my-4 aspect-auto max-h-64 w-full rounded-lg object-cover\" alt=\"Trnava\"/>\r\n        <div class=\"mb-2 flex items-center justify-between gap-4\">\r\n            <h2>{tour['name']}</h2>\r\n            <ContextButton tour={tour} status={relationship}/>\r\n            <!-- <div class=\"badge\">\r\n              <svg width=\"20px\" height=\"20px\" stroke-width=\"1.5\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <path d=\"M12 2v4M12 18v4M22 12h-4M6 12H2M4.929 4.929l2.828 2.828M16.243 16.243l2.828 2.828M19.071 4.929l-2.828 2.828M7.757 16.243L4.93 19.07\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg\r\n              >Prebiehajúci výlet\r\n            </div> -->\r\n        </div>\r\n        <p class=\"mb-4 border-b border-neutral-800 pb-4\">{tour['description']}</p>\r\n        <section class=\"mb-4 border-b border-neutral-800 pb-4\">\r\n            <h3 class=\"mb-2\">Zastávky</h3>\r\n            <section class=\"flex justify-between gap-32\">\r\n                <aside class=\"grow basis-2/6\">\r\n                    <div class=\"text-neutral-400\">\r\n                        {#each [...tour['mapPoints']] as [key, value]}\r\n                            <button type=\"button\" on:click|preventDefault={() => selectPoint(value['name'])}\r\n                                    class=\"cursor-pointer {chosenPoint['name'] === value['name'] ? 'stop-selected' : 'hover:text-neutral-100'}\">\r\n                                {$formatStopName(value)}\r\n                            </button>\r\n                        {/each}\r\n                    </div>\r\n                </aside>\r\n                <PointDetail mapPoint={chosenPoint} visited={hasVisited(chosenPoint.name)} status={relationship}\r\n                             ongoingTour={$ongoingData} on:update={handleUpdate}/>\r\n            </section>\r\n        </section>\r\n        <div class=\"grid grid-cols-3 gap-6\">\r\n            <div>\r\n                <h3>Hodnotenie</h3>\r\n                {#if tour['averageRating'] === -1}\r\n                    <p>Žiadne hodnotenie</p>\r\n                {:else}\r\n                    <p>{tour['averageRating']} z 5</p>\r\n                {/if}\r\n            </div>\r\n            <div>\r\n                <h3>Vytvoril</h3>\r\n                <p>{tour['ownerUsername']}</p>\r\n            </div>\r\n            <div>\r\n                <h3>Celkový počet zastávok</h3>\r\n                <p>{tour['mapPoints'].size}</p>\r\n            </div>\r\n            <div>\r\n                <h3>Približná dĺžka trvania</h3>\r\n                <p>{tour['approximateLength']} minút</p>\r\n            </div>\r\n            <div>\r\n                <h3>Typ</h3>\r\n                {#if tour['isPaidOnly'] === true}\r\n                    <p>Platený</p>\r\n                {:else}\r\n                    <p>Dostupný pre všetkých</p>\r\n                {/if}\r\n            </div>\r\n        </div>\r\n    </section>\r\n</main>\r\n"],"names":["src_url_equal","img","img_src_value","ctx","attr","img_alt_value","insert_hydration","target","anchor","dirty","button","p","t0_value","create_if_block_2","create_if_block","create_if_block_1","div1","append_hydration","div0","a","set_data","t0","ongoingTour","$$props","mapPoint","visited","status","dispatch","createEventDispatcher","markAsVisited","$$invalidate","button_class_value","t5_value","t8_value","t19_value","t27_value","each_value","i","main","h1","section2","svg","path","h2","p0","section1","h30","section0","aside","div7","div2","h31","div3","h32","p1","div4","h33","p2","div5","h34","p3","div6","h35","goBack","data","tourId","tour","relationship","ongoingData","writable","$ongoingData","chosenPoint","hasVisited","pointName","selectPoint","handleUpdate","ev","formatStopName","derived","value","el"],"mappings":"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"}